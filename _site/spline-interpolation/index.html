<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">

  <head profile="http://gmpg.org/xfn/11">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <title>Spline interpolation</title>
    <link rel="stylesheet" href="../css/screen.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
    <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" />
    <link rel="alternate" type="application/rss+xml" title="Martin Thoma RSS Feed" href="http://martinthoma.github.io//feed/" /><!--TODO-->
    <link rel="shortcut icon" href="http://martinthoma.github.io//favicon.ico" type="image/x-icon" />

    <link rel="canonical" href="/spline-interpolation" /><!-- TODO: Check if this is absolute url-->
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@themoosemind"/>
    <meta name="twitter:domain" content="Martin Thoma"/>
    <meta name="twitter:creator" content="@themoosemind"/>
    <meta name="twitter:image:src" content="http://martin-thoma.com/wp-content/uploads/2013/11/polygon-is-point-inside-thumb.png"/><!-- TODO-->
    <meta name="twitter:image:src" content="http://martin-thoma.com/wp-content/uploads/2013/11/polygon-order.png"/><!-- TODO-->
    <meta name="twitter:image:src" content="http://martin-thoma.com/wp-content/uploads/2013/11/polygon-is-point-inside.png"/><!-- TODO-->
    
    <meta name="twitter:description" content="" />
    
    <meta name="twitter:title" content="Spline interpolation - Martin Thoma"/>
    <meta name="twitter:url" content="http://martinthoma.github.io//check-point-inside-polygon/"/>

    <link rel='stylesheet' id='toc-screen-css'  href='http://martin-thoma.com/wp-content/plugins/table-of-contents-plus/screen.css?ver=1308' type='text/css' media='all' />
<script type='text/javascript' src='http://martin-thoma.com/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='http://martin-thoma.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<link rel='shortlink' href='http://martin-thoma.com/?p=76726' /><!-- TODO -->
<style type="text/css">div#toc_container {width: 275px;}</style>
<style type="text/css" id="syntaxhighlighteranchor"></style>

</head>
<body>
	<div id="wrapper">
		<div id="container" class="container">
			<div class="span-16">
                <div id="header">
                    <h1><a href="http://martinthoma.github.io/">Martin Thoma</a></h1>
				    <h2>A blog about Code, the Web and Cyberculture.</h2>
			    </div>
                <div class="navcontainer">
					<ul id="nav">
						<li><a href="http://martinthoma.github.io/">Home</a></li>
						<li class="page_item page-item-41"><a href="http://martinthoma.github.io//about-martin-thoma/">About Me</a></li>
                        <li class="page_item page-item-91"><a href="http://martinthoma.github.io//imprint/">Imprint</a></li>
					</ul>
				</div>
            	<div id="content">	
                    <div class="post-76726 post type-post status-publish format-standard hentry category-code tag-algorithms tag-geometry tag-python clearfix" id="post-76726">
                        <h2 class="title entry-title">Spline interpolation</h2>
			            <div class="postdate">
                            <span>
                                June 
                                30th
                                  , 
                                2013
                            </span>
                            <!-- TODO<span><a href="check-point-inside-polygon/#respond" title="Comment on How to check if a point is inside of a polygon?">No Comments</a></span>-->
                        </div>
			
						<div class="entry">
                            <p>Just like before with polynomial interpolation, we have a list of $n+1$ given point $(x_i, y_i)$ with $x_0 &lt; x_1 &lt; \dots &lt; x_n$.</p>

<p>We want to find a function that goes through those points and approximates the underlying function that produced that points as good as possible.</p>

<h2>Polynomial interpolation</h2>


<p>The problem of polynomial interpolation were oscillations at the end of the interval you wanted to interpolate (see <a href="http://martin-thoma.com/html5/polynom-interpolation.htm?function=1%2F(25*x*x%2B1)&evaluationSteps=0.01&X_MIN=-1.5&X_MAX=1.5&Y_MAX=1.2&Y_MIN=-1.2&X_TICKS_STEPS=0.2&Y_TICKS_STEPS=0.2&X_FROM=-1&X_TO=1&N_EVALUATION_POINTS=10&points=%5B%5D&tschebyscheffSwitch=true&equallySwitch=true">interactive example</a>):</p>

<p>[caption id="attachment_72001" align="aligncenter" width="300"]<a href="http://martin-thoma.com/wp-content/uploads/2013/06/polynomial-interpolation-oscillation.png"><img src="http://martin-thoma.com/wp-content/uploads/2013/06/polynomial-interpolation-oscillation-300x105.png" alt="Oscillations you get with polynomial interpolation" width="300" height="105" class="size-medium wp-image-72001" /></a> Oscillations you get with polynomial interpolation[/caption]</p>

<p>As you can see, polynomial interpolation with equally spaced points is very, very bad at the ends of the interval. Tschebyscheff spaced points are much better, but you can still see that the interpolated function is different from the original.</p>

<h2>Splines</h2>


<p>A way to solve this problem are splines. A spline is a piecewise-defined function that goes through some points (aka knots) and is smooth.</p>

<p>More formally: Let $s: [x_0,x_n] \rightarrow \mathbb{R}$ be a spline. Then:</p>

<ol style="list-style-type: none;">
  <li>(S1) <strong>cubic</strong>: $\forall i \in \{1, \dots, n\}: s|_{x_{i-1}, x_i}$ is a cubic function</li>
  <li>(S2) <strong>interpolation</strong>: $\forall i \in \{0, \dots, n\}: s(x_i) = y_i$</li>
  <li>(S3) <strong>smooth</strong>: $s \in C^2([x_0, x_n])$ and $\int_{x_0}^{x_n} s''(x)^2 \mathrm{d}x$ is minimal</li> 
</ol>


<p>When you use a cubic function $a x<sup>3</sup> + b x<sup>2</sup> + cx + d$ for each of the $n$ intervals that we got by our $n+1$ points, you have $4n$ variables that you need to calculate.</p>

<p>Condition (S2) gives two equations per interval which makes $2n$ equations of the form:</p>

<p>$
\begin{align}
y_i     &amp;= a_i x_i<sup>3</sup>     &amp;&amp;+ b_i x_i<sup>2</sup>     &amp;&amp;+ c_i x_i     &amp;&amp;+ d_i\
y<em>{i+1} &amp;= a_i x</em>{i+1}^3 &amp;&amp;+ b_i x<em>{i+1}^2 &amp;&amp;+ c_i x</em>{i+1} &amp;&amp;+ d_i
\end{align}
$</p>

<p>At first glance condition (S3) - $s \in C<sup>2</sup>([x_0, x_n])$ - seems to be redundant with (S1) - $s$ is piecewise cubic. Every polynomial is in $C^\infty(\mathbb{R})$, so it certainly is in $C<sup>2</sup>([x_0, x_n])$.<br/>
That's correct. But $s$ is not a polynomial. It's only piecewise-defined as a polynomial. That makes a difference at the ends of the intervals. And it gives us $2n-2$ more equations:</p>

<p>$\displaystyle
\begin{align}
s_i' (x<em>{i}) &amp;= s</em>{i+1}'(x<em>{i}) \;\;\;  &amp;&amp;\forall i=1, \dots, n-1\
s_i''(x</em>{i}) &amp;= s<em>{i+1}''(x</em>{i}) \;\;\; &amp;&amp;\forall i=1, \dots, n-1
\end{align}
$</p>

<p>which is equivalent to</p>

<p>$\displaystyle
\begin{align}
3a_i x_i<sup>2</sup> + 2b_i x_i + c_i &amp;= 3a<em>{i+1} x_i<sup>2</sup> + 2b</em>{i+1} x_i + c<em>{i+1} \;\;\; &amp;&amp;\forall i=1, \dots, n-1\
6a_i x_i + 2b_i &amp;= 6a</em>{i+1} x_i + 2b_{i+1} \;\;\; &amp;&amp;\forall i=1, \dots, n-1
\end{align}
$</p>

<p>All equations we have are linear. Please note that the variables we want to determine are $a_i, b_i, c_i, d_i$. So $x_i<sup>3</sup>$ is simply a multiplicative constant that we have to evaluate before we solve our system of equations.</p>

<p>But at the moment, we only have $2n+2\cdot(n-1) = 4n -2$ equations, but we have $4n$ variables. So we need ancillary conditions to solve this linear system of equations.</p>

<h2>Possible ancillary conditions</h2>


<ul>
  <li><strong>natural splines</strong>: $s''(x_0) =0, \;\;\; s''(x_n) = 0$</li>
  <li><strong>clamped splines</strong>: $s'(x_0) = f'(x_0),\;\;\; s'(x_n)= f'(x_n)$ where $y_0'$ and $y_n'$ can be any value</li>
  <li><strong>periodic</strong>: $s'(x_0) = s'(x_n), \;\;\; s''(x_0) = s''(x_n)$</li>
  <li><strong>not-a-knot</strong>: $s_1''' = s_2''', \;\;\; s_{n-1}''' = s_{n}'''$</li>
</ul>


<p>George MacKerron shows how the results can differ in his article <a href="http://blog.mackerron.com/2011/01/01/javascript-cubic-splines/">Cubic splines in JavaScript (via CoffeeScript)</a>:</p>

<p>[caption id="attachment_72221" align="aligncenter" width="500"]<a href="http://martin-thoma.com/wp-content/uploads/2013/06/ancillary-conditions-splines-results.png"><img src="http://martin-thoma.com/wp-content/uploads/2013/06/ancillary-conditions-splines-results.png" alt="Different results for different ancillary conditions" width="500" height="267" class="size-full wp-image-72221" /></a> Different results for different ancillary conditions[/caption]</p>

<h2>Code for natural splines</h2>


<p>I will store splines as a list of maps. Each map is one piece of the spline and has:</p>

<ul>
  <li>$u$: Start of the interval</li>
  <li>$v$: End of the interval</li>
  <li>$a,b,c,d$: cubic function $ax^3 + bx^2 + cx +d$</li>
</ul>


<p>Please note that I didn't test the code below. It's likely that there are errors with indices.</p>

<div class="highlight"><pre><code class="python"><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="k">def</span> <span class="nf">niceCubicPolynomial</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="s">&quot; x^3&quot;</span>
    <span class="k">elif</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="si">%.2f</span><span class="s">x^3&quot;</span> <span class="o">%</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">+ x^2&quot;</span>
    <span class="k">elif</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">+ </span><span class="si">%.2f</span><span class="s">x^2&quot;</span> <span class="o">%</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\t\t</span><span class="s">&quot;</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;c&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">+ x&quot;</span>
    <span class="k">elif</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;c&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">+ </span><span class="si">%.2f</span><span class="s">x&quot;</span> <span class="o">%</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;c&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\t\t</span><span class="s">&quot;</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;d&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">+ </span><span class="si">%.2f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;d&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">tmp</span>

<span class="k">def</span> <span class="nf">getSpline</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; points should be a list of maps, </span>
<span class="sd">        where each map represents a point and has &quot;x&quot; and &quot;y&quot; &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span><span class="o">,</span> <span class="nn">scipy.linalg</span>

    <span class="c"># sort points by x value</span>
    <span class="n">points</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">point</span><span class="p">:</span> <span class="n">point</span><span class="p">[</span><span class="s">&quot;x&quot;</span><span class="p">])</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c"># Set up a system of equations of form Ax=b</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="c"># 2n equations from condtions (S2)</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;y&quot;</span><span class="p">]</span>

        <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span>
        <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">b</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;y&quot;</span><span class="p">]</span>

        <span class="c"># 2n-2 equations for (S3):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c"># point i is an inner point</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c"># Natural spline:</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">6</span><span class="o">*</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">2</span>
    <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">0</span>

    <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">6</span><span class="o">*</span><span class="n">points</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">2</span>
    <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">0</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">spline</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&quot;u&quot;</span><span class="p">:</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">],</span> <span class="s">&quot;v&quot;</span><span class="p">:</span> <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">],</span>
                        <span class="s">&quot;a&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">0</span><span class="p">]),</span>
                        <span class="s">&quot;b&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="s">&quot;c&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]),</span>
                        <span class="s">&quot;d&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])})</span>
    <span class="k">return</span> <span class="n">spline</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="p">})</span>
    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&quot;x&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>
    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&quot;x&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">})</span>
    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&quot;x&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s">&quot;y&quot;</span><span class="p">:</span> <span class="mi">70</span><span class="p">})</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">getSpline</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">spline</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="s">&quot;[</span><span class="si">%.2f</span><span class="s">, </span><span class="si">%.2f</span><span class="s">]:&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s">&quot;u&quot;</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="s">&quot;v&quot;</span><span class="p">])</span>
        <span class="n">tmp</span> <span class="o">+=</span> <span class="n">niceCubicPolynomial</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</code></pre></div>




<h2>See also</h2>


<ul>
  <li><a href="http://math.stackexchange.com/q/430141/6876">How do the different ancillary conditions for splines differ?</a></li>
</ul>


						</div>
						<div class="postmeta">Posted in 
                            
                                <a href="/category/code">code</a>
                             | Tags: 
                            
                                
                                    <a href="/tag/numerics">numerics</a>
                             by <a rel="author" class="vcard author" href="http://martin-thoma.com/author/moose/"><span class="fn">Martin Thoma</span></a> on <span class="updated"><span class="value-title" title="2013-06-30 11:58:20 UTC">
                                June 
                                30th
                                  , 
                                2013</span></span></div>

							<div class="navigation clearfix">
                                <div class="alignleft">
                                
                                    &laquo; <a href="/zero-mean-normalized-cross-correlation" rel="prev">Zero Mean Normalized Cross-Correlation</a>
                                 
                                </div>
								<div class="alignright">
                                
                                    <a href="/music-videos" rel="next">Music videos</a> &raquo;
                                 
                                </div>
							</div>
							
                            You can skip to the end and leave a response.
	
						</div>
                        <div id="respond">
                            <h3>Leave a Reply</h3>
                            <div class="cancel-comment-reply">
	                            <small><a rel="nofollow" id="cancel-comment-reply-link" href="/check-point-inside-polygon/#respond" style="display:none;">Click here to cancel reply.</a></small>
                            </div>
    <!----------------- comment discuss code -------------------------------------------------------------------->
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'martinthoma'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    <!----------------- comment discuss code -------------------------------------------------------------------->
                        </div>
                    </div>
			    </div>
            <div class="span-8 last">
                <div id="subscriptions">
                    <a href="http://martin-thoma.com/feed/"><img src="../css/images/rss.png" alt="Subscribe to RSS Feed" title="Subscribe to RSS Feed" /></a>		
		<a href="http://twitter.com/#!/themoosemind" title="Follow me on Twitter!"><img src="../css/images/twitter.png" title="Follow me on Twitter!" alt="Follow me on Twitter!"  /></a>    </div>
	<div id="sidebar">
        <ul>
            <li id="search">
				 
<div class="searchlayout">
    <form method="get" id="searchform" action="http://martin-thoma.com/"> 
        <input type="text" value="Search" 
            name="s" id="s"  onblur="if (this.value == '')  {this.value = 'Search';}"  
            onfocus="if (this.value == 'Search') {this.value = '';}" />
        <input type="image" src="../css/images/search.gif" style="border:0; vertical-align: top;" /> 
    </form>
</div>			</li>
        </ul>
            			<div class="addthis_toolbox">   
    			    <div class="custom_images">
    			            <a class="addthis_button_twitter"><img src="../css/images/socialicons/twitter.png" width="32" height="32" alt="Twitter" /></a>
    			            <a class="addthis_button_delicious"><img src="../css/images/socialicons/delicious.png" width="32" height="32" alt="Delicious" /></a>
    			            <a class="addthis_button_facebook"><img src="../css/images/socialicons/facebook.png" width="32" height="32" alt="Facebook" /></a>
    			            <a class="addthis_button_digg"><img src="../css/images/socialicons/digg.png" width="32" height="32" alt="Digg" /></a>
    			            <a class="addthis_button_stumbleupon"><img src="../css/images/socialicons/stumbleupon.png" width="32" height="32" alt="Stumbleupon" /></a>
    			            <a class="addthis_button_favorites"><img src="../css/images/socialicons/favorites.png" width="32" height="32" alt="Favorites" /></a>
    			            <a class="addthis_button_more"><img src="../css/images/socialicons/more.png" width="32" height="32" alt="More" /></a>
    			    </div>
    			    <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js?pub=xa-4a65e1d93cd75e94"></script>
    			</div>
    					        
		<ul>
    <li id="categories-3" class="widget widget_categories">
    <h2 class="widgettitle">Categories</h2>
        <ul>
	        <li class="cat-item cat-item-11"><a href="../category/code/" title="Tipps for coding in different languages like Python oder C++.">Code</a></li>
	        <li class="cat-item cat-item-21"><a href="../category/web/" title="New emerging websites and technologies.">The Web</a></li>
	        <li class="cat-item cat-item-31"><a href="../category/cyberculture/" title="Lolcats, planking, Trollfaces, ...">Cyberculture</a></li>
	        <li class="cat-item cat-item-3404"><a href="../category/maths/" title="View all posts filed under Mathematics">Mathematics</a></li>
	        <li class="cat-item cat-item-881"><a href="../category/bits-and-bytes/" title="Sometimes posts don&#039;t fit in any category.">My bits and bytes</a></li>
	        <li class="cat-item cat-item-41"><a href="../category/deutschland/" title="[All Posts here are written in German about German topics] - Die Bahn, unsere Politik und Europa.">German posts</a></li>
		</ul>
    </li>
    <li id="tag_cloud-3" class="widget widget_tag_cloud"><h2 class="widgettitle">Tags</h2><div class="tagcloud">
<a href='../tag/advertising/' class='tag-link-401' title='5 topics' style='font-size: 8pt;'>advertising</a>
<a href='../tag/algebra/' class='tag-link-3271' title='6 topics' style='font-size: 9.0537634408602pt;'>Algebra</a>
<a href='../tag/algorithms/' class='tag-link-1981' title='7 topics' style='font-size: 9.8064516129032pt;'>algorithms</a>
<a href='../tag/analysis/' class='tag-link-1481' title='6 topics' style='font-size: 9.0537634408602pt;'>analysis</a>
<a href='../tag/assembly-language/' class='tag-link-1401' title='5 topics' style='font-size: 8pt;'>Assembly language</a>
<a href='../tag/bash/' class='tag-link-731' title='6 topics' style='font-size: 9.0537634408602pt;'>Bash</a>
<a href='../tag/c/' class='tag-link-1101' title='26 topics' style='font-size: 17.784946236559pt;'>C</a>
<a href='../tag/challenge/' class='tag-link-671' title='7 topics' style='font-size: 9.8064516129032pt;'>Challenge</a>
<a href='../tag/clip/' class='tag-link-861' title='10 topics' style='font-size: 11.913978494624pt;'>Clip</a>
<a href='../tag/command-line/' class='tag-link-351' title='5 topics' style='font-size: 8pt;'>Command Line</a>
<a href='../tag/computer-science/' class='tag-link-611' title='6 topics' style='font-size: 9.0537634408602pt;'>Computer science</a>
<a href='../tag/cpp/' class='tag-link-3101' title='6 topics' style='font-size: 9.0537634408602pt;'>CPP</a>
<a href='../tag/digitaltechnik/' class='tag-link-2441' title='8 topics' style='font-size: 10.559139784946pt;'>Digitaltechnik</a>
<a href='../tag/flashgames/' class='tag-link-641' title='6 topics' style='font-size: 9.0537634408602pt;'>Flashgames</a>
<a href='../tag/funny/' class='tag-link-121' title='14 topics' style='font-size: 14.021505376344pt;'>funny</a>
<a href='../tag/geometry/' class='tag-link-2151' title='5 topics' style='font-size: 8pt;'>Geometry</a>
<a href='../tag/google/' class='tag-link-271' title='9 topics' style='font-size: 11.311827956989pt;'>Google</a>
<a href='../tag/google-code-jam/' class='tag-link-1531' title='8 topics' style='font-size: 10.559139784946pt;'>Google Code Jam</a>
<a href='../tag/it-security/' class='tag-link-691' title='8 topics' style='font-size: 10.559139784946pt;'>IT-Security</a>
<a href='../tag/java/' class='tag-link-1151' title='33 topics' style='font-size: 19.290322580645pt;'>Java</a>
<a href='../tag/kit/' class='tag-link-1051' title='12 topics' style='font-size: 12.967741935484pt;'>KIT</a>
<a href='../tag/klausur/' class='tag-link-1971' title='19 topics' style='font-size: 15.827956989247pt;'>Klausur</a>
<a href='../tag/latex/' class='tag-link-1021' title='23 topics' style='font-size: 17.032258064516pt;'>LaTeX</a>
<a href='../tag/learning/' class='tag-link-651' title='15 topics' style='font-size: 14.322580645161pt;'>learning</a>
<a href='../tag/linear-algebra/' class='tag-link-1241' title='18 topics' style='font-size: 15.52688172043pt;'>Linear algebra</a>
<a href='../tag/linux/' class='tag-link-331' title='12 topics' style='font-size: 12.967741935484pt;'>Linux</a>
<a href='../tag/mathematics/' class='tag-link-991' title='50 topics' style='font-size: 22pt;'>mathematics</a>
<a href='../tag/matrix/' class='tag-link-1471' title='8 topics' style='font-size: 10.559139784946pt;'>Matrix</a>
<a href='../tag/operating-systems/' class='tag-link-2481' title='5 topics' style='font-size: 8pt;'>Operating Systems</a>
<a href='../tag/os/' class='tag-link-1461' title='5 topics' style='font-size: 8pt;'>OS</a>
<a href='../tag/php/' class='tag-link-441' title='6 topics' style='font-size: 9.0537634408602pt;'>PHP</a>
<a href='../tag/programming/' class='tag-link-71' title='41 topics' style='font-size: 20.645161290323pt;'>Programming</a>
<a href='../tag/project-euler/' class='tag-link-1521' title='9 topics' style='font-size: 11.311827956989pt;'>Project Euler</a>
<a href='../tag/puzzle/' class='tag-link-1961' title='20 topics' style='font-size: 16.129032258065pt;'>puzzle</a>
<a href='../tag/python/' class='tag-link-91' title='38 topics' style='font-size: 20.193548387097pt;'>Python</a>
<a href='../tag/swt-i/' class='tag-link-1631' title='8 topics' style='font-size: 10.559139784946pt;'>SWT I</a>
<a href='../tag/theoretical-computer-science/' class='tag-link-1341' title='9 topics' style='font-size: 11.311827956989pt;'>Theoretical computer science</a>
<a href='../tag/tikz/' class='tag-link-1771' title='6 topics' style='font-size: 9.0537634408602pt;'>Tikz</a>
<a href='../tag/ubuntu/' class='tag-link-341' title='5 topics' style='font-size: 8pt;'>Ubuntu</a>
<a href='../tag/video/' class='tag-link-151' title='11 topics' style='font-size: 12.516129032258pt;'>Video</a>
<a href='../tag/vimeo/' class='tag-link-421' title='8 topics' style='font-size: 10.559139784946pt;'>Vimeo</a>
<a href='../tag/web-development/' class='tag-link-461' title='9 topics' style='font-size: 11.311827956989pt;'>Web Development</a>
<a href='../tag/wikipedia/' class='tag-link-111' title='5 topics' style='font-size: 8pt;'>Wikipedia</a>
<a href='../tag/wolframalpha/' class='tag-link-491' title='5 topics' style='font-size: 8pt;'>Wolfram|Alpha</a>
<a href='../tag/youtube/' class='tag-link-171' title='11 topics' style='font-size: 12.516129032258pt;'>YouTube</a></div>
</li>		</ul>
	</div>
</div>
		</div><!--/container-->
			<div id="footer">
				<a href="http://martin-thoma.com"><strong>Martin Thoma</strong></a> -  A blog about Code, the Web and Cyberculture. <br />
                <div class="footer-credits">
                    <a href="http://flexithemes.com/themes/modern-style/">Modern Style</a> theme by <a href="http://flexithemes.com/">FlexiThemes</a>
                </div>
			</div><!--/footer-->
            
	</div><!--/wrapper-->
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    
    processEscapes: true
  }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<!-- MathJax Latex Plugin installed -->
<script type='text/javascript'>
/* <![CDATA[ */
var tocplus = {"visibility_show":"show","visibility_hide":"hide","width":"275px"};
/* ]]> */
</script>
<script type='text/javascript' src='http://martin-thoma.com/wp-content/plugins/table-of-contents-plus/front.js?ver=1308'></script>

</body>
</html>
