<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Colorize your scripts output</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Martin Thoma</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Colorize your scripts output</h2>
<p class="meta">30 Sep 2011</p>

<div class="post">
<p>The bash is very nice if you want to know exactly what your scripts are doing. Unfortunately, its almost always white colored text on a black background, without any accentuation. No bold text, nothing underlined and no colors are used.</p>

<p>You can change this standard behaviour. You can add color to your output.</p>

<p>This is the way you do it:</p>

<p>The mini-program tput can initialize a terminal or query terminfo database. If you want to know more about it, you can take a look at the <a href="http://linux.die.net/man/1/tput">tput manpage</a>.</p>

<h2>A quick example</h2>


<p>[bash]# Text color variables
txtred=$(tput setaf 1)    # Red
txtreset=$(tput sgr0)     # Reset your text
echo "Roses are ${txtred}red${txtreset}."[/bash]</p>

<p>Simply copy this example line by line and then you'll see the expected example.</p>

<p>A shorter way would be
[bash]echo "Roses are <code>tput setaf 1</code>red<code>tput sgr0</code>."[/bash]</p>

<h2>The sgr attribuge</h2>


<p>[bash]tput sgr 0 1     turn off standout; turn on underline
tput sgr 0 0     turn off standout; turn off underline
tput sgr 1 1     turn on standout; turn on underline
tput sgr 1 0     turn on standout; turn off underline
tput sgr0        short for sgr 0 0[/bash]</p>

<h2>The setaf attribute</h2>


<p>[bash]setaf 1 Red
setaf 2 Green
setaf 3 Yellow
setaf 4 Blue
setaf 5 Purple
setaf 6 Cyan
setaf 7 Gray[/bash]</p>

<h2>Misc</h2>


<p>Make your text bold:
[bash]tput bold[/bash]</p>

<p>Reset your style:
[bash]tput sgr0[/bash]</p>

<h2>Advanced Example</h2>


<p>Imagine you had a script which generated much output. All messages are important for you, but some are more important than others. You definitely want to see all "[ERROR]" output. So you want to apply a red and bold modification to the stream.</p>

<p>This is the way how "[ERROR]" gets red and bold:
[bash]<code>tput setaf 1``tput bold</code>[ERROR]<code>tput sgr0</code>[/bash]
You can test it with
[bash]echo "<code>tput setaf 1``tput bold</code>[ERROR]<code>tput sgr0</code>"[/bash]</p>

<p>I've created a little python script called output.py for testing purposes. It simply outputs a quite long <a href="http://en.wikipedia.org/wiki/Lorem_ipsum">Lorem ipsum</a> text with some random [ERROR] messages.</p>

<p>The next task is to replace the [ERROR] messages. The tool of my choice is sed. See the <a href="http://linux.die.net/man/1/sed">sed man page</a> for more information. The basic usage is
[bash]sed 's/search/replace/'[/bash]</p>

<p>So we pipe the output to sed:
[bash]python output.py | sed 's/[ERROR]/MYLOOOOOOOOOOOOOOOOOONGTEST/'[/bash]</p>

<p>And now we bring it all together:
[bash]python output.py | sed 's/[ERROR]/<code>tput setaf 1``tput bold</code>[ERROR]<code>tput sgr0</code>/'[/bash]</p>

<p>Doesn't work? Well, lets analyse it. Instead of replacing <code>tput setaf 1</code> it gets printed directly. This means, something we did prevented the bash of replacing our command. If you look carefully at the command, you might see that I used ' instead of ". If you change this, everything is fine:</p>

<p>[bash]python output.py | sed "s/[ERROR]/<code>tput setaf 1``tput bold</code>[ERROR]<code>tput sgr0</code>/"[/bash]</p>

<h2>Colorize C / C++ output</h2>


<p>You need <a href="http://en.wikipedia.org/wiki/ANSI_escape_code">ANSI color codes</a>:
[c]#include &lt;stdio.h></p>

<p>int main()
{
    printf("&#92;&#48;33[30m%s&#92;&#48;33[0m\n", "black?");
    printf("&#92;&#48;33[31m%s&#92;&#48;33[0m\n", "red");
    printf("&#92;&#48;33[32m%s&#92;&#48;33[0m\n", "lime");
    printf("&#92;&#48;33[33m%s&#92;&#48;33[0m\n", "yellow");
    printf("&#92;&#48;33[34m%s&#92;&#48;33[0m\n", "blue");
    printf("&#92;&#48;33[35m%s&#92;&#48;33[0m\n", "gray");
    printf("&#92;&#48;33[36m%s&#92;&#48;33[0m\n", "blue");
    printf("&#92;&#48;33[37m%s&#92;&#48;33[0m\n", "light gray");
    printf("&#92;&#48;33[38m%s&#92;&#48;33[0m\n", "black?");
    printf("&#92;&#48;33[39m%s&#92;&#48;33[0m\n", "black?");
    printf("&#92;&#48;33[41m%s&#92;&#48;33[0m\n", "red background");
    printf("&#92;&#48;33[1;34m%s&#92;&#48;33[0m\n", "bold and blue");
    printf("&#92;&#48;33[4m%s&#92;&#48;33[0m\n", "underlined");
    printf("&#92;&#48;33[9m%s&#92;&#48;33[0m\n", "strike");
    return 0;
}[/c]</p>

<p>\033 is the ASCII 27 ESC character. It has to be followed by "[". After that you can write one or two numbers separated by ";". Then you have to write "m". You can get back to standard output with "\033[0m".
The numbers 30&ndash;37 change the color, 4 is a single underline.</p>

<p>I guess these will also work for Java, but I didn't test it.</p>

<p>Do you know what setaf or sgr stand for? Do you know further "terminal enhancement" tricks? Just leave a post!</p>


<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
</div>

            <div class="footer">
    <div class="contact">
      <p>
        Martin<br />
        What You Are<br />
        you@example.com
      </p>
    </div>
    <div class="contact">
      <p>
        <a href="https://github.com/yourusername">github.com/yourusername</a><br />
        <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
      </p>
    </div>
  </div>

        </div>
    </body>
</html>
