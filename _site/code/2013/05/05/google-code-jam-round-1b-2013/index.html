<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Google Code Jam &ndash; Round 1B 2013</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Martin Thoma</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Google Code Jam &ndash; Round 1B 2013</h2>
<p class="meta">05 May 2013</p>

<div class="post">
<ul>
<li>Problem A (<a href="https://code.google.com/codejam/contest/2434486/dashboard#s=p0">Osmos</a>):
  <ul>
    <li>Small Set: 4668/7250 users (64%)</li>
    <li>Large Set: 3537/4578 users (77%)</li>
  </ul>
<li>Problem B (<a href="https://code.google.com/codejam/contest/2434486/dashboard#s=p1">Falling Diamonds</a>):
  <ul>
    <li>Small Set: 952/1882 users (51%)</li>
    <li>Large Set: 525/724 users (73%)</li>
  </ul>
</li>
<li>Problem C (<a href="https://code.google.com/codejam/contest/2434486/dashboard#s=p2">Garbled Email</a>):
  <ul>
    <li>Small Set: 444/896 users (50%)</li>
    <li>Large Set: 255/345 users (74%)</li>
  </ul>
</li>
</ul>


<p>More information are on <a href="http://www.go-hero.net/jam/13/round/2">go-hero.net</a>.</p>

<h2>Osmos</h2>




<div class="highlight"><pre><code class="python"><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="k">def</span> <span class="nf">howBigDoIget</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">motes</span><span class="p">):</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">motes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">motes</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">(</span><span class="n">motes</span><span class="p">)</span>
        <span class="n">motes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">motes</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">A</span>

<span class="k">def</span> <span class="nf">stepsNeededForNext</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">motes</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">motes</span><span class="p">)</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">A</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">10</span><span class="o">**</span><span class="mi">12</span>
    <span class="k">while</span> <span class="n">A</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">+=</span> <span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">steps</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">steps</span>

<span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">motes</span><span class="p">):</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">howBigDoIget</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">motes</span><span class="p">)</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">motes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">motes</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">stepsNeededForNext</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">motes</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">motes</span><span class="p">)):</span>
            <span class="n">steps</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">motes</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">steps</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">A</span> <span class="o">+=</span> <span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">howBigDoIget</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">motes</span><span class="p">)</span>
        <span class="n">steps</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">steps</span>
 
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">testcases</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">caseNr</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">testcases</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">raw_input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="n">motes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">raw_input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)))</span>
        <span class="n">copyed</span> <span class="o">=</span> <span class="n">motes</span><span class="p">[:]</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">motes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">solution</span> <span class="o">&gt;</span> <span class="n">N</span><span class="p">:</span>
            <span class="n">solution</span> <span class="o">=</span> <span class="n">N</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Case #</span><span class="si">%i</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">caseNr</span><span class="p">,</span> <span class="n">solution</span><span class="p">))</span>
</code></pre></div>




<h2>Falling Diamonds</h2>


<p>Oncee you've read the task, you should understand some very basic ideas:</p>

<ul>
  <li>First of all, diamonds only fall at $x=0$!</li>
  <li>If your target coordinates are $(x,y)$, you have the same output as for $(-x,y)$, as everything is symmetric.</li>
  <li>You have to get a basis for your diamonds pyramid. I've colored the basis in yellow in the images below.</li>
  <li>When your target is above the ground, you can let the diamond slide down to calculate the size of the basis.</li>
</ul>


<p>[caption id="attachment_65431" align="aligncenter" width="512"]<a href="http://martin-thoma.com/wp-content/uploads/2013/05/falling-diamonds-base.jpg"><img src="http://martin-thoma.com/wp-content/uploads/2013/05/falling-diamonds-base.jpg" alt="A basis for diamonds" width="512" height="323" class="size-full wp-image-65431" /></a> You have to get those yellow diamonds first, before you can get the orange one.[/caption]</p>

<p>[caption id="attachment_65441" align="aligncenter" width="512"]<a href="http://martin-thoma.com/wp-content/uploads/2013/05/falling-diamonds-slide.jpg"><img src="http://martin-thoma.com/wp-content/uploads/2013/05/falling-diamonds-slide.jpg" alt="Let Diamonds slide down" width="512" height="254" class="size-full wp-image-65441" /></a> Let Diamonds slide down[/caption]</p>

<p>Note that you don't have to calculate a probabilty for the yellow pyramids. You get those with probability of 1.</p>

<p>What I've forgot: You should also catch the case that you can fill up the next bigger pyramid. If this is possible, you can guarantee that you will reach your target $(x,y)$.</p>

<p>The rest is simple math. You have $rest$ diamonds left after you've build the base (yellow). Then you need $y+1$ diamonds slide to the right side. The probability that you have exactly $k$ hits while making $N$ tries with a probability of 50% is $\binom{N}{k} \cdot (\frac{1}{2})<sup>N</sup>$. You want at least $k$ hits, so you want $\sum_{i=k}^N \binom{N}{i} \cdot (\frac{1}{2})<sup>N</sup>$.</p>

<div class="highlight"><pre><code class="python"><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">gmpy</span>

<span class="sd">&quot;&quot;&quot; Calculate the binomial coefficient &quot;&quot;&quot;</span>
<span class="k">def</span> <span class="nf">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">gmpy</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>

<span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    @param N: Number of diamonds</span>
<span class="sd">    @param x,y: Target coordinate</span>
<span class="sd">    @return: possiblity, that a diamond will be at coordinate (x,y) </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">y</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">N</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>

    <span class="c"># From this point, x != 0 is True</span>

    <span class="n">xTmp</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="c"># let target slide down</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">xTmp</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">baseDiamands</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

    <span class="c"># are there enough diamonds left after you&#39;ve build the basis?</span>
    <span class="n">rest</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="n">baseDiamands</span>
    <span class="k">if</span> <span class="n">rest</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>

    <span class="c"># are there enough diamonds left so that you can guarantee that </span>
    <span class="c"># you will  fill up the next bigger pyramid at least to the </span>
    <span class="c"># target position?</span>
    <span class="n">biggerBaseDiamonds</span> <span class="o">=</span> <span class="n">baseDiamands</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&gt;=</span> <span class="n">biggerBaseDiamonds</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">1.0</span>

    <span class="c"># some math:</span>
    <span class="c"># bernoulli</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">hitsNeeded</span> <span class="o">=</span> <span class="n">y</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hitsNeeded</span><span class="p">,</span> <span class="n">rest</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">prob</span> <span class="o">+=</span> <span class="n">binomial</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">prob</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="n">rest</span>
 
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">testcases</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
      
    <span class="k">for</span> <span class="n">caseNr</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">testcases</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">raw_input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Case #</span><span class="si">%i</span><span class="s">: </span><span class="si">%.9Lf</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">caseNr</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">y</span><span class="p">)))</span>
</code></pre></div>





<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
</div>

            <div class="footer">
    <div class="contact">
      <p>
        Martin<br />
        What You Are<br />
        you@example.com
      </p>
    </div>
    <div class="contact">
      <p>
        <a href="https://github.com/yourusername">github.com/yourusername</a><br />
        <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
      </p>
    </div>
  </div>

        </div>
    </body>
</html>
