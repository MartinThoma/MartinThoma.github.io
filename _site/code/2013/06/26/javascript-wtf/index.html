<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>JavaScript: WTF?!?</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Martin Thoma</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>JavaScript: WTF?!?</h2>
<p class="meta">26 Jun 2013</p>

<div class="post">
<p>JavaScript is THE web programming language. It gets interpreted by your browser and web applications like Google Mail, Google Maps and Facebook make heavy use of them. Almost always, when you see something working smoothly / interactive, you see JavaScript in action.</p>

<p>But JavaScript has a lot of "features" which are ... well, I don't have words for those. Just continue reading.</p>

<p>Most of the following content is from a StackOverflow question <a href="http://stackoverflow.com/q/1995113/562769">Strangest language feature</a></p>

<h2>Weak typing</h2>


<p><strong>Example</strong>
[javascript]console.log(3..toString());[/javascript]</p>

<p><strong>Output</strong>
[bash]'3'[/bash]</p>

<p><strong>Explanation</strong>
<strong>3.</strong> is a floating point and can get converted to a string. But <code>3.toString()</code> gives
[bash]SyntaxError: Unexpected token ILLEGAL [/bash]</p>

<h2>Weak typing and string concatenation</h2>


<p><strong>Example</strong>
[javascript]
console.log('5' + 3);
console.log('5' - 3);
[/javascript]</p>

<p><strong>Output</strong>
[bash]'53'
2[/bash]</p>

<p><strong>Explanation</strong>
JavaScript automatically converts datatypes and <code>+</code> is used for string concatenation and for addition.</p>

<p>In the first case, as the first datatype is a string and <code>+</code> is defined for strings as concatenation, JS converts <code>3</code> to <code>'3'</code> which results in the string <code>'53'</code>.</p>

<p>In the second case, <code>-</code> is only defined for subtraction so <code>'5'</code> gets converted to a number (int? float? I don't know. I guess int.)</p>

<h2>Automatic semicolons</h2>


<p><strong>Example 1</strong></p>

<p>[javascript]
function test() {
    return
    {
        id : 1338,
        title : 'This is a test'
    };
}</p>

<p>console.log(test());
[/javascript]</p>

<p><strong>Example 2</strong>
[javascript]
function test() {
    return
        2 + 2;
}</p>

<p>console.log(test());
[/javascript]</p>

<p><strong>Output 1</strong>
[bash]Uncaught SyntaxError: Unexpected token :[/bash]</p>

<p><strong>Output 2</strong>
[bash]undefined[/bash]</p>

<p><strong>Explanation</strong>
JS adds a <code>;</code> at every line end. Automatically. You can't prevent it.</p>

<p>Please note that the second output is no error! It has a (valid) return value of <code>undefined</code>.</p>

<h2>Truth table</h2>


<p><strong>Example</strong>
[javascript collapse="true"]
console.log("------- 0 == XYZ ---------");
console.log(0 == 0);
console.log(0 == false);
console.log(0 == '');
console.log(0 == null);
console.log(0 == undefined);
console.log(0 == " \t\r\n");
console.log(0 == '0');
console.log(0 == 'false');
console.log("------- false == XYZ ---------");
console.log(false == false);
console.log(false == '');
console.log(false == null);
console.log(false == undefined);
console.log(false == " \t\r\n");
console.log(false == '0');
console.log(false == 'false');
console.log("------- '' == XYZ ---------");
console.log('' == '');
console.log('' == null);
console.log('' == undefined);
console.log('' == " \t\r\n");
console.log('' == '0');
console.log('' == 'false');
console.log("------- null == XYZ ---------");
console.log(null == null);
console.log(null == undefined);
console.log(null == " \t\r\n");
console.log(null == '0');
console.log(null == 'false');
console.log("------- undefined == XYZ ---------");
console.log(undefined == undefined);
console.log(undefined == " \t\r\n");
console.log(undefined == '0');
console.log(undefined == 'false');
console.log("-------  \t\r\n == XYZ ---------");
console.log(" \t\r\n" == " \t\r\n");
console.log(" \t\r\n" == '0');
console.log(" \t\r\n" == 'false');
console.log("------- '0' == XYZ ---------");
console.log('0' == '0');
console.log('0' == 'false');
console.log("------- 'false' == XYZ ---------");
console.log('false' == 'false');
console.log("--------------------");
console.log("-------  XYZ == 0 ---------");
console.log(0 == 0);
console.log(false == 0);
console.log('' == 0);
console.log(null == 0);
console.log(undefined == 0);
console.log(" \t\r\n" == 0);
console.log('0' == 0);
console.log('false' == 0);
console.log("-------  XYZ == false ---------");
console.log(false == false);
console.log('' == false);
console.log(null == false);
console.log(undefined == false);
console.log(" \t\r\n" == false);
console.log('0' == false);
console.log('false' == false);
console.log("-------  XYZ == '' ---------");
console.log('' == '');
console.log(null == '');
console.log(undefined == '');
console.log(" \t\r\n" == '');
console.log('0' == '');
console.log('false' == '');
console.log("-------  XYZ == null ---------");
console.log(null == null);
console.log(undefined == null);
console.log(" \t\r\n" == null);
console.log('0' == null);
console.log('false' == null);
console.log("-------  XYZ == undefined ---------");
console.log(undefined == undefined);
console.log(" \t\r\n" == undefined);
console.log('0' == undefined);
console.log('false' == undefined);
console.log("-------  XYZ == \t\r\n ---------");
console.log(" \t\r\n" == " \t\r\n");
console.log('0' == " \t\r\n");
console.log('false' == " \t\r\n");
console.log("-------  XYZ == '0' ---------");
console.log('0' == '0');
console.log('false' == '0');
console.log("-------  XYZ == 'false' ---------");
console.log('false' == 'false');
[/javascript]</p>

<p><strong>Output</strong></p>

<table>
<tr>
    <th>==</th>
    <th>0</th>
    <th>false</th>
    <th>''</th>
    <th>null</th>
    <th>undefined</th>
    <th>" \t\r\n"</th>
    <th>'0'</th>
    <th>'false'</th>
</tr>
<tr>
    <th>0</th>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
</tr>
<tr>
    <th>false</th>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
</tr>
<tr>
    <th>''</th>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
</tr>
<tr>
    <th>null</th>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
</tr>
<tr>
    <th>undefined</th>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
</tr>
<tr>
    <th>" \t\r\n"</th>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
</tr>
<tr>
    <th>'0'</th>
    <td style="background-color: lime;">true</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: lime;">true</td>
    <td style="background-color: red;">false</td>
</tr>
<tr>
    <th>'false'</th>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: red;">false</td>
    <td style="background-color: lime;">true</td>
</tr>
</table>


<p><strong>Explanation</strong>
Wow. This is fucked up. I've expected that strings compared to anything that is not the string itself evaluates to false.</p>

<p>At least the table is symmetric and the diagonal is true. Please also note that JavaScript has a <code>===</code> operator.</p>

<h2>The truth</h2>


<p><strong>Example</strong>
[javascript]
console.log(2 == [2]);
console.log(2 == [[2]]);
[/javascript]</p>

<p><strong>Output</strong>
[bash]
true
true
[/bash]</p>

<p><strong>Explanation</strong>
At <a href="http://stackoverflow.com/a/1724551/562769">StackOverflow</a></p>

<h2>Date</h2>


<p><strong>Example</strong>
[javascript]
var futureDate = new Date(2010,77,154);
console.log(futureDate);
console.log(futureDate.getYear());
[/javascript]</p>

<p><strong>Output</strong>
[bash]Tue Nov 01 2016 00:00:00 GMT+0100 (CET)
116[/bash]</p>

<p><strong>Explanation</strong>
77 months and 154 days from the 0th day of 0th month of 2010</p>

<p>You should use <code>getFullYear()</code> instead of <code>getYear()</code>, as the later one returns <code>year - 1900</code> (Why? When is this useful?)</p>

<h2>Integer overflow</h2>


<p><strong>Example</strong>
[javascript]
console.log(111111111111111111111);
[/javascript]</p>

<p><strong>Output</strong>
[bash]111111111111111110000 [/bash]</p>

<p><strong>Explanation</strong>
It's ok that JavaScript fails at handling this integer. I think it converts this to a float, but I'm not sure about that. But no matter what it does here, it doesn't throw an error. That's bad. How is a developer supposed to know in a big application know when something went wrong?</p>

<h2>Function parameters</h2>


<blockquote>In Javascript, declaring the parameters a function accepts is only a convenience to the programmer. All variables passed through the function call are accessible by the keyword <code>arguments</code>. So the following would alert "world":
[javascript]
function blah(){
    alert(arguments[1]);
}

blah("hello", "world");
[/javascript]
</blockquote>


<p><a href="http://stackoverflow.com/a/2023908/562769">Source</a> on StackOverflow</p>

<h2>Global variables</h2>


<p><strong>Example</strong>
[javascript]
var a = 12;</p>

<p>function test() {
  a = 1337;
}
test();
console.log(a);
[/javascript]</p>

<p><strong>Output</strong>
[bash]1337[/bash]</p>

<p><strong>Explanation</strong>
When you forget to use <code>var</code> inside of <code>test()</code> you might accidentally use a global variable.</p>

<h2>See also</h2>


<p>Do you know some more JavaScript WTFs?</p>

<p>You might also be interested in <a href="http://martin-thoma.com/php-a-strange-language/" title="PHP: A strange language">PHP: A strange language</a></p>


<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>
</div>

            <div class="footer">
    <div class="contact">
      <p>
        Martin<br />
        What You Are<br />
        you@example.com
      </p>
    </div>
    <div class="contact">
      <p>
        <a href="https://github.com/yourusername">github.com/yourusername</a><br />
        <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
      </p>
    </div>
  </div>

        </div>
    </body>
</html>
