<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
  <!-- type: head.html -->
  <head profile="http://gmpg.org/xfn/11">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <title>Solving equations of upper triangular matrices</title>
    <link link rel="stylesheet" href="http://martinthoma.github.io/css/201312281236.min.css" type="text/css" media="screen" />

    <link rel="alternate" type="application/rss+xml" title="Martin Thoma RSS Feed" href="http://martinthoma.github.io/feed/" /><!--TODO-->
    <link rel="shortcut icon" href="http://martinthoma.github.io/favicon.ico" type="image/x-icon" />

    <link rel="canonical" href="http://martinthoma.github.io/solving-equations-of-upper-triangular-matrices" />
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@themoosemind"/>
    <meta name="twitter:domain" content="Martin Thoma"/>
    <meta name="twitter:creator" content="@themoosemind"/>

    
        <meta name="twitter:image:src" content="http://martinthoma.github.io/images/2013/05/upper-triangular-matrix.png"/>
    

    
        <meta name="twitter:description" content="" />
    

    <meta name="twitter:title" content="Solving equations of upper triangular matrices - Martin Thoma"/>
    <meta name="twitter:url" content="http://martinthoma.github.io/solving-equations-of-upper-triangular-matrices"/>
<script type='text/javascript' src="http://martinthoma.github.io/js/jquery.js"></script>
<script type='text/javascript' src="http://martinthoma.github.io/js/jquery-migrate.min.js"></script>
<style type="text/css">div#toc_container {width: 275px;}</style>
<style type="text/css" id="syntaxhighlighteranchor"></style>

</head>

<!-- type: post.html -->
<body>
	<div id="wrapper">
		<div id="container" class="container">
			<div class="span-16">
                <!-- type: header.html -->
<div id="header">
    <h1><a href="http://martinthoma.github.io">Martin Thoma</a></h1>
    <h2>A blog about Code, the Web and Cyberculture.</h2>
</div>
<div class="navcontainer">
	<ul id="nav">
		<li class=""><a href="http://martinthoma.github.io">Home</a></li>
		<li class="page_item page-item-41 "><a href="http://martinthoma.github.io/about-martin-thoma/">About Me</a></li>
        <li class="page_item page-item-91 "><a href="http://martinthoma.github.io/imprint/">Imprint</a></li>
	</ul>
</div>

            	<div id="content">	
                    <div class="post type-post status-publish format-standard hentry clearfix">
                        <h2 class="title entry-title">Solving equations of upper triangular matrices</h2>
			            <div class="postdate">
                            <span>
                                May 
                                20th,
                                  
                                2013
                            </span>
                            <!-- TODO<span><a href="check-point-inside-polygon/#respond" title="Comment on How to check if a point is inside of a polygon?">No Comments</a></span>-->
                        </div>
			
						<div class="entry">
                            <p>Suppose you have an equation like $R \cdot x = b$ with $R \in \mathbb{R}^{n \times n}$ and $x,b \in \mathbb{R}^n$. $b$ and $R$ are given and you want to solve for $x$.</p>

<div id="toc_container" class="toc_light_blue no_bullets">
   <p class="toc_title">Contents</p>
   <ul class="toc_list">
      <li class="toc_level-1 toc_section-1">
         <a href="#tocAnchor-1-1"><span class="tocnumber">1</span> <span class="toctext">Example</span></a>
         <ul>
            <li class="toc_level-2 toc_section-2">
               <a href="#tocAnchor-1-1-1"><span class="tocnumber">1.1</span> <span class="toctext">First step: Solve for $x_5$</span></a>
            </li>
            <li class="toc_level-2 toc_section-3">
               <a href="#tocAnchor-1-1-2"><span class="tocnumber">1.2</span> <span class="toctext">Second step: update</span></a>
            </li>
         </ul>
      </li>
      <li class="toc_level-1 toc_section-4">
         <a href="#tocAnchor-1-4"><span class="tocnumber">2</span> <span class="toctext">Python straightforward algorithm</span></a>
      </li>
      <li class="toc_level-1 toc_section-5">
         <a href="#tocAnchor-1-5"><span class="tocnumber">3</span> <span class="toctext">A better algorithm</span></a>
      </li>
      <li class="toc_level-1 toc_section-6">
         <a href="#tocAnchor-1-6"><span class="tocnumber">4</span> <span class="toctext">Conversion to Fraction</span></a>
      </li>
      <li class="toc_level-1 toc_section-7">
         <a href="#tocAnchor-1-7"><span class="tocnumber">5</span> <span class="toctext">Time complexity</span></a>
      </li>
      <li class="toc_level-1 toc_section-8">
         <a href="#tocAnchor-1-8"><span class="tocnumber">6</span> <span class="toctext">Space complexity</span></a>
      </li>
      <li class="toc_level-1 toc_section-9">
         <a href="#tocAnchor-1-9"><span class="tocnumber">7</span> <span class="toctext">Notes</span></a>
      </li>
   </ul>
</div><h2 id="tocAnchor-1-1">Example</h2>

<p>With $n=5$, the problem could look like this:</p>

<p>$\begin{pmatrix}
2 &amp; 7 &amp; 1 &amp; 8 &amp; 2\
0 &amp; 8 &amp; 1 &amp; 8 &amp; 2\
0 &amp; 0 &amp; 8 &amp; 4 &amp; 5\
0 &amp; 0 &amp; 0 &amp; 9 &amp; 0\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 4
\end{pmatrix} \cdot 
\begin{pmatrix} x<em>1 \ x</em>2 \ x<em>3 \ x</em>4 \ x_5 \end{pmatrix} =
\begin{pmatrix}   3 \ 1   \ 4   \ 1   \ 5   \end{pmatrix}$</p>

<p>This is only a shorthand for:
$
\begin{align}
2 \cdot x<em>1 + 7 \cdot x</em>2 + 1 \cdot x<em>3 + 8 \cdot x</em>4 + 2 \cdot x<em>5 &amp;= 3\
              8 \cdot x</em>2 + 1 \cdot x<em>3 + 8 \cdot x</em>4 + 2 \cdot x<em>5 &amp;= 1\
                            8 \cdot x</em>3 + 4 \cdot x<em>4 + 5 \cdot x</em>5 &amp;= 4\
                                          9 \cdot x<em>4 + 0 \cdot x</em>5 &amp;= 1\
                                                        4 \cdot x_5 &amp;= 5
\end{align}
$</p>

<h3 id="tocAnchor-1-1-1">First step: Solve for $x_5$</h3>

<p>First you see that $x_5 = \frac{5}{4}$. So you divide $b$ by the current row.</p>

<div class="important">Don't divide through 0. When you would have to divide by 0 and b is 0, this system has an infinite amount of solutions. When you would have to divide by 0 and b is not 0, then this system has no solution.</div>

<p>Now you replace every occurrence of $x_5$ in the system of equations above:</p>

<p>$
\begin{align}
2 \cdot x<em>1 + 7 \cdot x</em>2 + 1 \cdot x<em>3 + 8 \cdot x</em>4 + 2 \cdot \frac{5}{4} &amp;= 3\
              8 \cdot x<em>2 + 1 \cdot x</em>3 + 8 \cdot x<em>4 + 2 \cdot \frac{5}{4} &amp;= 1\
                            8 \cdot x</em>3 + 4 \cdot x<em>4 + 5 \cdot \frac{5}{4} &amp;= 4\
                                          9 \cdot x</em>4 + 0 \cdot \frac{5}{4} &amp;= 1\
                                                        4 \cdot \frac{5}{4} &amp;= 5
\end{align}
$</p>

<p>Now you make the multiplications and remove the first trivial line.</p>

<p>$
\begin{align}
2 \cdot x<em>1 + 7 \cdot x</em>2 + 1 \cdot x<em>3 + 8 \cdot x</em>4 + \frac{5}{2} &amp;= 3\
              8 \cdot x<em>2 + 1 \cdot x</em>3 + 8 \cdot x<em>4 + \frac{5}{2} &amp;= 1\
                            8 \cdot x</em>3 + 4 \cdot x<em>4 + \frac{25}{4} &amp;= 4\
                                          9 \cdot x</em>4 + 0 &amp;= 1\
\end{align}
$</p>

<h3 id="tocAnchor-1-1-2">Second step: update</h3>

<p>Get the constant factors to the right side of the equations:
$
\begin{align}
2 \cdot x<em>1 + 7 \cdot x</em>2 + 1 \cdot x<em>3 + 8 \cdot x</em>4 &amp;= \frac{1}{2} \
              8 \cdot x<em>2 + 1 \cdot x</em>3 + 8 \cdot x<em>4 &amp;= -\frac{3}{2} \
                            8 \cdot x</em>3 + 4 \cdot x<em>4 &amp;= -\frac{9}{4}\
                                          9 \cdot x</em>4 &amp;= 1\
\end{align}
$</p>

<p>You're now in the same situation as in the first step. Next you will solve for $x<em>4$, then for $x</em>3, x<em>2$ and finally for $x</em>1$.</p>

<p>This is called "back substitution".</p>

<p><a href="http://www.wolframalpha.com/input/?i=%7B%7B2%2C7%2C1%2C8%2C2%7D%2C%7B0%2C8%2C1%2C8%2C2%7D%2C%7B0%2C0%2C8%2C4%2C5%7D%2C%7B0%2C0%2C0%2C9%2C0%7D%2C%7B0%2C0%2C0%2C0%2C4%7D%7D%5E-1*%7B%7B3%7D%2C%7B1%7D%2C%7B4%7D%2C%7B1%7D%2C%7B5%7D%7D">According to Wolfram|Alpha</a>, the solution is:</p>

<p>$x = \frac{1}{4608} \cdot \begin{pmatrix}4017\-1182\-1552\512\5760\end{pmatrix} = 
\begin{pmatrix}\frac{1339}{1536} \ -\frac{197}{768} \ -\frac{97}{288} \ \frac{1}{9} \ \frac{5}{4}\end{pmatrix}$</p>

<h2 id="tocAnchor-1-4">Python straightforward algorithm</h2>

<p>I will use <a href="http://docs.python.org/2/library/fractions.html">fractions</a> for operations as I don't want to lose precision while dividing.</p>

<div class="highlight">
   <pre><code class="python"><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="k">def</span> <span class="nf">solveUpperTriangularMatrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="c"># Convert R and b to Fraction</span>
    <span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
    <span class="n">fR</span><span class="p">,</span> <span class="n">fb</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
        <span class="n">fLine</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="n">fLine</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Fraction</span><span class="p">(</span><span class="n">el</span><span class="p">))</span>
        <span class="n">fR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fLine</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">fb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Fraction</span><span class="p">(</span><span class="n">el</span><span class="p">))</span>

    <span class="c"># The solution will be here</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fR</span><span class="p">[</span><span class="n">step</span><span class="p">][</span><span class="n">step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fb</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="s">"No solution"</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s">"Infinity solutions"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">fb</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">/</span> <span class="n">fR</span><span class="p">[</span><span class="n">step</span><span class="p">][</span><span class="n">step</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">fb</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">-=</span> <span class="n">fR</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">step</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
    <span class="n">b</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">solveUpperTriangularMatrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c"># Convert x to float</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="tocAnchor-1-5">A better algorithm</h2>

<p>Just like for <a href="http://martin-thoma.com/solving-equations-of-unipotent-lower-triangular-matrices/" title="Solving equations of unipotent lower triangular matrices">unipotent lower triangular matrices</a>, we can operate directly on the given input:</p>

<div class="highlight">
   <pre><code class="python"><span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="k">def</span> <span class="nf">solveUpperTriangularMatrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="c"># Convert R and b to Fraction</span>
    <span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="n">R</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
        <span class="n">b</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>

    <span class="c"># The solution will be here</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">R</span><span class="p">[</span><span class="n">step</span><span class="p">][</span><span class="n">step</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="s">"No solution"</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s">"Infinity solutions"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">/</span> <span class="n">R</span><span class="p">[</span><span class="n">step</span><span class="p">][</span><span class="n">step</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">step</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">b</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">-=</span> <span class="n">R</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">step</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
    <span class="n">b</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">solveUpperTriangularMatrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="tocAnchor-1-6">Conversion to Fraction</h2>

<p>You could think that the conversion to fraction is not necessary. But if you simply remove line 5 to 16, you will get:</p>

<div class="highlight">
   <pre><code class="bash"><span class="o">[</span>1, 0, -1, 0, 1<span class="o">]</span>
</code></pre>
</div>

<p>because of integer arithmetic. When you convert the input to float before passing it to <code>solveUpperTriangularMatrix</code>, you will get </p>

<div class="highlight">
   <pre><code class="bash"><span class="o">[</span>0.8717447916666666, -0.25651041666666663, -0.3368055555555556, 0.1111111111111111, 1.25<span class="o">]</span>
</code></pre>
</div>

<p>which is almost the same as when we calculated with Fraction and converted to float afterwards:</p>

<div class="highlight">
   <pre><code class="bash"><span class="o">[</span>0.8717447916666666, -0.2565104166666667, -0.3368055555555556, 0.1111111111111111, 1.25<span class="o">]</span>
</code></pre>
</div>

<p>So: Using Fractions needs some computing time, but you will get better results.</p>

<h2 id="tocAnchor-1-7">Time complexity</h2>

<p>I'll analyze the second algorithm.</p>

<p>The conversion of our input data is obviously in $\mathcal{O}(n^2)$. Let's only analyse the part after the conversion.</p>

<p>Assume that there is exactly one solution and that line 15-21 take $c<em>1$ operations and line 24 takes $c</em>2$ operations.</p>

<p>Then we would have a total of </p>

<p>$\begin{align}
\text{Operations} &amp;= \sum<em>{i=1}^n \left ( c</em>1 +  \sum<em>{j=1}^{i-1} c</em>2 \right )\
&amp;= \sum<em>{i=1}^n c</em>1 + \sum<em>{i=1}^n \sum</em>{j=1}^{i-1} c<em>2\
&amp;= n \cdot c</em>1 + c<em>2 \cdot \left (\sum</em>{i=1}^n \sum<em>{j=1}^{i-1} 1 \right )\
&amp;= n \cdot c</em>1 + c<em>2 \cdot \left (\sum</em>{i=1}^n (i-1) \right )\
&amp;= n \cdot c<em>1 + c</em>2 \cdot \left ((\sum<em>{i=1}^n i) - (\sum</em>{i=1}^n 1) \right )\
&amp;= n \cdot c<em>1 + c</em>2 \cdot \left (\frac{n^2+n}{2} - n \right )\
&amp;= n \cdot c<em>1 + (n^2-n) \cdot \frac{c</em>2}{2}\
\end{align}$</p>

<p>So the algorithms time complexity is in $\Theta(n^2) \subsetneq \mathcal{O}(n^2)$.</p>

<h2 id="tocAnchor-1-8">Space complexity</h2>

<p>Please note that I take advantage of Pythons dynamic typing system. I think it's difficult to see space complexity in python programs. But when you make the same in C++, you will see that you will need space in $\mathcal{O}(n)$ when you do the conversion. Without the conversion, you're in $\mathcal{O}(1)$.</p>

<p>I guess you might want to leave this choice to the user of your functions. When he wants better results, he should give the input as Fraction. When he wants to get results rather faster, he should give the input as float.</p>

<h2 id="tocAnchor-1-9">Notes</h2>

<p>In this algorithm, we don't need anything below the diagonal.</p>
						</div>
						<div class="postmeta">Posted in 
                            
                                <a href="http://martinthoma.github.io/category/code/">code</a><!--TODO: Displayed category name should be upper case! -->
                             | Tags: 
                            
                                
                                    <a href="http://martinthoma.github.io/tag/python/">Python</a>
                                
                            
                                , <a href="http://martinthoma.github.io/tag/mathematics/">mathematics</a>
                                
                            
                                , <a href="http://martinthoma.github.io/tag/matrix/">Matrix</a>
                                
                            
                                , <a href="http://martinthoma.github.io/tag/systems of equations/">systems of equations</a>
                                
                            
                                , <a href="http://martinthoma.github.io/tag/numerics/">numerics</a>
                                
                             by <a rel="author" class="vcard author" href="http://martinthoma.github.io/author/martin-thoma/"><span class="fn">Martin Thoma</span></a> on <span class="updated"><span class="value-title" title="2013-05-20 08:41:49 UTC">
                                May 
                                20th
                                  , 
                                2013</span></span></div>

							<div class="navigation clearfix">
                                <div class="alignleft">
                                
                                    &laquo; <a href="http://martinthoma.github.io/solving-equations-of-unipotent-lower-triangular-matrices/" rel="prev">Solving equations of lower unitriangular matrices</a>
                                 
                                </div>
								<div class="alignright">
                                
                                    <a href="http://martinthoma.github.io/generating-many-prime-numbers/" rel="next">Generating many prime numbers</a> &raquo;
                                 
                                </div>
							</div>
	
						</div>
                        <div id="respond">
                            <h3>Leave a Reply</h3>
                            <div class="cancel-comment-reply">
	                            <small><a rel="nofollow" id="cancel-comment-reply-link" href="/check-point-inside-polygon/#respond" style="display:none;">Click here to cancel reply.</a></small>
                            </div>
                                <!-- comment discuss code -->
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'martinthoma'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    <!-- comment discuss code -->

                        </div>
                    </div>
			    </div>
            <div class="span-8 last">
                <div id="subscriptions">
<a href="http://martinthoma.github.io/feed/"><img src="http://martinthoma.github.io/css/images/rss.png" alt="Subscribe to RSS Feed" title="Subscribe to RSS Feed" /></a>		
<a href="https://twitter.com/#!/themoosemind" title="Follow me on Twitter!"><img src="http://martinthoma.github.io/css/images/twitter.png" title="Follow me on Twitter!" alt="Follow me on Twitter!"  /></a>
</div>

	            <div id="sidebar">
                <!-- type: searchbox.html - TODO-->
<ul>
    <li id="search">
        <div class="searchlayout">
            <form method="get" id="searchform" action="http://martinthoma.github.io/search/">
                <input type="text" value="Search" 
                    name="s" id="s"  onblur="if (this.value == '')  {this.value = 'Search';}"  
                    onfocus="if (this.value == 'Search') {this.value = '';}" />
                <input type="image" src="http://martinthoma.github.io/css/images/search.gif" style="border:0; vertical-align: top;" /> 
            </form>
        </div>
    </li>
</ul>

                <div class="addthis_toolbox">   
    <div class="custom_images">
            <a class="addthis_button_twitter"><img src="http://martinthoma.github.io/css/images/socialicons/twitter.png" width="32" height="32" alt="Twitter" /></a>
            <a class="addthis_button_delicious"><img src="http://martinthoma.github.io/css/images/socialicons/delicious.png" width="32" height="32" alt="Delicious" /></a>
            <a class="addthis_button_facebook"><img src="http://martinthoma.github.io/css/images/socialicons/facebook.png" width="32" height="32" alt="Facebook" /></a>
            <a class="addthis_button_digg"><img src="http://martinthoma.github.io/css/images/socialicons/digg.png" width="32" height="32" alt="Digg" /></a>
            <a class="addthis_button_stumbleupon"><img src="http://martinthoma.github.io/css/images/socialicons/stumbleupon.png" width="32" height="32" alt="Stumbleupon" /></a>
            <a class="addthis_button_favorites"><img src="http://martinthoma.github.io/css/images/socialicons/favorites.png" width="32" height="32" alt="Favorites" /></a>
            <a class="addthis_button_more"><img src="http://martinthoma.github.io/css/images/socialicons/more.png" width="32" height="32" alt="More" /></a>
    </div>
    <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js?pub=xa-4a65e1d93cd75e94"></script>
</div>
			        
		        <ul>
                    <li id="categories-3" class="widget widget_categories">
                        <!-- type: categories -->
<h2 class="widgettitle">Categories</h2>
    <ul>
        <li class="cat-item cat-item-11"><a href="http://martinthoma.github.io/category/code/" title="Tipps for coding in different languages like Python oder C++.">Code</a></li>
        <li class="cat-item cat-item-21"><a href="http://martinthoma.github.io/category/web/" title="New emerging websites and technologies.">The Web</a></li>
        <li class="cat-item cat-item-31"><a href="http://martinthoma.github.io/category/cyberculture/" title="Lolcats, planking, Trollfaces, ...">Cyberculture</a></li>
        <li class="cat-item cat-item-3404"><a href="http://martinthoma.github.io/category/maths/" title="View all posts filed under Mathematics">Mathematics</a></li>
        <li class="cat-item cat-item-881"><a href="http://martinthoma.github.io/category/bits-and-bytes/" title="Sometimes posts don&#039;t fit in any category.">My bits and bytes</a></li>
        <li class="cat-item cat-item-41"><a href="http://martinthoma.github.io/category/deutschland/" title="[All Posts here are written in German about German topics] - Die Bahn, unsere Politik und Europa.">German posts</a></li>
	</ul>

                    </li>
                    <li id="tag_cloud-3" class="widget widget_tag_cloud">
                        <h2 class="widgettitle">Tags</h2>
                        <div class="tagcloud"><a style='font-size: 135.95%' href='http://martinthoma.github.io/tag/theoretical computer science/' title='9 topics'>Theoretical computer science</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/wikipedia/' title='5 topics'>Wikipedia</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/advertising/' title='5 topics'>advertising</a>
<a style='font-size: 254.49%' href='http://martinthoma.github.io/tag/programming/' title='41 topics'>Programming</a>
<a style='font-size: 248.55%' href='http://martinthoma.github.io/tag/python/' title='38 topics'>Python</a>
<a style='font-size: 135.95%' href='http://martinthoma.github.io/tag/google/' title='9 topics'>Google</a>
<a style='font-size: 218.88%' href='http://martinthoma.github.io/tag/c/' title='26 topics'>C</a>
<a style='font-size: 126.74%' href='http://martinthoma.github.io/tag/google code jam/' title='8 topics'>Google Code Jam</a>
<a style='font-size: 158.44%' href='http://martinthoma.github.io/tag/linux/' title='12 topics'>Linux</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/ubuntu/' title='5 topics'>Ubuntu</a>
<a style='font-size: 126.74%' href='http://martinthoma.github.io/tag/algorithms/' title='8 topics'>algorithms</a>
<a style='font-size: 270.00%' href='http://martinthoma.github.io/tag/mathematics/' title='50 topics'>mathematics</a>
<a style='font-size: 144.19%' href='http://martinthoma.github.io/tag/lecture-notes/' title='10 topics'>lecture-notes</a>
<a style='font-size: 190.13%' href='http://martinthoma.github.io/tag/linear algebra/' title='18 topics'>Linear algebra</a>
<a style='font-size: 104.25%' href='http://martinthoma.github.io/tag/php/' title='6 topics'>PHP</a>
<a style='font-size: 126.74%' href='http://martinthoma.github.io/tag/it-security/' title='8 topics'>IT-Security</a>
<a style='font-size: 194.36%' href='http://martinthoma.github.io/tag/klausur/' title='19 topics'>Klausur</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/os/' title='5 topics'>OS</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/operating systems/' title='5 topics'>Operating Systems</a>
<a style='font-size: 237.52%' href='http://martinthoma.github.io/tag/java/' title='33 topics'>Java</a>
<a style='font-size: 209.30%' href='http://martinthoma.github.io/tag/latex/' title='23 topics'>LaTeX</a>
<a style='font-size: 104.25%' href='http://martinthoma.github.io/tag/analysis/' title='6 topics'>analysis</a>
<a style='font-size: 198.37%' href='http://martinthoma.github.io/tag/puzzle/' title='20 topics'>puzzle</a>
<a style='font-size: 126.74%' href='http://martinthoma.github.io/tag/digitaltechnik/' title='8 topics'>Digitaltechnik</a>
<a style='font-size: 158.44%' href='http://martinthoma.github.io/tag/kit/' title='12 topics'>KIT</a>
<a style='font-size: 135.95%' href='http://martinthoma.github.io/tag/project euler/' title='9 topics'>Project Euler</a>
<a style='font-size: 126.74%' href='http://martinthoma.github.io/tag/swt i/' title='8 topics'>SWT I</a>
<a style='font-size: 170.49%' href='http://martinthoma.github.io/tag/funny/' title='14 topics'>funny</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/wolfram|alpha/' title='5 topics'>Wolfram|Alpha</a>
<a style='font-size: 104.25%' href='http://martinthoma.github.io/tag/computer science/' title='6 topics'>Computer science</a>
<a style='font-size: 126.74%' href='http://martinthoma.github.io/tag/vimeo/' title='8 topics'>Vimeo</a>
<a style='font-size: 144.19%' href='http://martinthoma.github.io/tag/clip/' title='10 topics'>Clip</a>
<a style='font-size: 151.64%' href='http://martinthoma.github.io/tag/youtube/' title='11 topics'>YouTube</a>
<a style='font-size: 126.74%' href='http://martinthoma.github.io/tag/matrix/' title='8 topics'>Matrix</a>
<a style='font-size: 135.95%' href='http://martinthoma.github.io/tag/web development/' title='9 topics'>Web Development</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/javascript/' title='5 topics'>JavaScript</a>
<a style='font-size: 104.25%' href='http://martinthoma.github.io/tag/cpp/' title='6 topics'>CPP</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/kogsys/' title='5 topics'>KogSys</a>
<a style='font-size: 116.30%' href='http://martinthoma.github.io/tag/challenge/' title='7 topics'>Challenge</a>
<a style='font-size: 104.25%' href='http://martinthoma.github.io/tag/algebra/' title='6 topics'>Algebra</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/geometry/' title='5 topics'>Geometry</a>
<a style='font-size: 104.25%' href='http://martinthoma.github.io/tag/flashgames/' title='6 topics'>Flashgames</a>
<a style='font-size: 175.88%' href='http://martinthoma.github.io/tag/learning/' title='15 topics'>learning</a>
<a style='font-size: 151.64%' href='http://martinthoma.github.io/tag/video/' title='11 topics'>Video</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/assembly language/' title='5 topics'>Assembly language</a>
<a style='font-size: 104.25%' href='http://martinthoma.github.io/tag/tikz/' title='6 topics'>Tikz</a>
<a style='font-size: 90.00%' href='http://martinthoma.github.io/tag/command line/' title='5 topics'>Command Line</a>
<a style='font-size: 104.25%' href='http://martinthoma.github.io/tag/bash/' title='6 topics'>Bash</a>
</div>
                    </li>
                </ul>
	            </div>
            </div>
		</div><!--/container-->
			<div id="footer">
				<a href="http://martinthoma.github.io"><strong>Martin Thoma</strong></a> -  A blog about Code, the Web and Cyberculture. <br />
                <div class="footer-credits">
                    <a href="http://flexithemes.com/themes/modern-style/">Modern Style</a> theme by <a href="http://flexithemes.com/">FlexiThemes</a>
                </div>
			</div><!--/footer-->
            
	</div><!--/wrapper-->
<!-- type: footer -->
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript">
<!--
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    
    processEscapes: true
  }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
// -->
</script>
<!-- MathJax Latex Plugin installed -->
<script type='text/javascript'>
/* <![CDATA[ */
var tocplus = {"visibility_show":"show","visibility_hide":"hide","width":"275px"};
/* ]]> */
</script>
<script type='text/javascript' src="http://martinthoma.github.io/js/tocplus-front.js"></script>

</body>
</html>

