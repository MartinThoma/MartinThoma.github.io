<!DOCTYPE html>
<html lang="en">
  <!-- type: head.html -->
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    
    

    
        <meta name="thumbnail" content="http://martin-thoma.com/images/logos/python.png" />
        <meta property="og:image" content="http://martin-thoma.com/images/logos/python.png" />
    

    <meta property="og:type" content="blog"/>

    <title>Python Markov Chain Packages</title>
    <link rel="stylesheet" href="http://martin-thoma.com/css/201505210854.min.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="http://martin-thoma.com/css/print.css" type="text/css" media="print" />
    <link rel="stylesheet" href="http://martin-thoma.com/css/handheld.css" type="text/css" media="only screen and (max-device-width: 480px)" />

    <link rel="alternate" type="application/rss+xml" title="Martin Thoma RSS Feed" href="http://martin-thoma.com/feed/" /><!--TODO-->
    <link rel="shortcut icon" href="http://martin-thoma.com/favicon.ico" type="image/x-icon" />

    <link rel="canonical" href="http://martin-thoma.com/python-markov-chain-packages" />
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:site" content="@themoosemind"/>
<meta name="twitter:creator" content="@themoosemind"/>
<meta name="twitter:title" content="Python Markov Chain Packages"/>

    <meta name="twitter:description" content="A blog about Code, the Web and Cyberculture" />


    <meta name="twitter:image" content="http://martin-thoma.com/images/logos/python.png"/>



<meta name="twitter:url" content="http://martin-thoma.com/python-markov-chain-packages"/>
<meta name="twitter:domain" content="Martin Thoma.com"/>


    <script type='text/javascript' src="http://martin-thoma.com/js/jquery.js"></script>
    <script type='text/javascript' src="http://martin-thoma.com/js/jquery-migrate.min.js"></script>
    <style type="text/css">div#toc_container {width: 275px;}</style>
    <style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<!-- type: post.html -->
<body>
	<div id="wrapper">
		<div id="container" class="container">
			<div class="span-16">
                <!-- type: header.html -->
<div id="header" role="banner">
    <h1><a href="http://martin-thoma.com">Martin Thoma</a></h1>
    <h2>A blog about Code, the Web and Cyberculture.</h2>
</div>
<nav class="navcontainer" role="navigation">
	<ul id="nav">
		<li class=""><a href="http://martin-thoma.com">Home</a></li>
		<li class="page_item page-item-41 "><a href="http://martin-thoma.com/author/martin-thoma/">About Me</a></li>
        <li class="page_item page-item-91 "><a href="http://martin-thoma.com/imprint/">Imprint</a></li>
	</ul>
</nav>

            	<div id="content">	
                    <article class="post type-post format-standard hentry clearfix ">
                        <h2 class="title entry-title">Python Markov Chain Packages</h2>
			            <div class="postdate entry-date">
                            <time datetime="2015-05-12T20:45:00+02:00">
                                May 
                                12th,
                                  
                                2015
                            </time>
                        </div>
			
						<div class="entry">
                            <p>Markov Chains are probabilistic processes which depend only on the previous
state and not on the complete history. One common example is a very simple
weather model: Either it is a rainy day (R) or a sunny day (S). On sunny days
you have a probability of 0.8 that the next day will be sunny, too. On rainy
days you have a probability of 0.6 that the next day will be rainy, too.
As you have only two possible weather conditions, the probability that it
changes from sunny do rainy is 0.2 and vice versa it is 0.4.</p>

<p>You can visualize this with a graph like this:</p>

<div style="width: 510px" class="wp-caption aligncenter">
   <a href="../images/2015/05/markov-chain-rain-sun.png">
      <img src="http://martin-thoma.com/captions/markov-chain-rain-sun.png" alt="Simple Markov chain weather model" width="500" height="237" class="" />
   </a>
   <p class="wp-caption-text">Simple Markov chain weather model</p>
</div>

<p>I am taking a course about markov chains this semester. Today, we've learned
a bit how to use R (a programming language) to do very basic tasks.</p>

<div id="toc_container" class="toc_light_blue no_bullets">
   <p class="toc_title">Contents</p>
   <ul class="toc_list">
      <li class="toc_level-1 toc_section-1">
         <a href="#tocAnchor-1-1"><span class="tocnumber">1</span> <span class="toctext">R vs Python</span></a>
      </li>
      <li class="toc_level-1 toc_section-2">
         <a href="#tocAnchor-1-2"><span class="tocnumber">2</span> <span class="toctext">Python Markov Packages</span></a>
         <ul>
            <li class="toc_level-2 toc_section-3">
               <a href="#tocAnchor-1-2-1"><span class="tocnumber">2.1</span> <span class="toctext">PyMarkovChain</span></a>
            </li>
            <li class="toc_level-2 toc_section-4">
               <a href="#tocAnchor-1-2-2"><span class="tocnumber">2.2</span> <span class="toctext">pyEMMA</span></a>
            </li>
            <li class="toc_level-2 toc_section-5">
               <a href="#tocAnchor-1-2-3"><span class="tocnumber">2.3</span> <span class="toctext">MarkovEquClasses</span></a>
            </li>
            <li class="toc_level-2 toc_section-6">
               <a href="#tocAnchor-1-2-4"><span class="tocnumber">2.4</span> <span class="toctext">PyMarkov</span></a>
            </li>
            <li class="toc_level-2 toc_section-7">
               <a href="#tocAnchor-1-2-5"><span class="tocnumber">2.5</span> <span class="toctext">Hidden Markov Models</span></a>
            </li>
         </ul>
      </li>
      <li class="toc_level-1 toc_section-8">
         <a href="#tocAnchor-1-8"><span class="tocnumber">3</span> <span class="toctext">TODO</span></a>
      </li>
   </ul>
</div><h2 id="tocAnchor-1-1">R vs Python</h2>

<p>The following will show some R code and then some Python code for the same
basic tasks. As an example, I'll use reproduction. The states are
$S_1 = \{AA, AA\}$, $S_2 = \{AA, Aa\}$, $S_3 = \{AA, aa\}$, $S_4=\{Aa,Aa\}$,
$S_5 = \{Aa, aa\}$ and $S_6 = \{aa, aa\}$.</p>

<p>The idea is that each pair of parents give birth to two children. The parents
$S_2 = \{AA, Aa\}$ can give birth to {{AA, AA}, {AA, Aa}, {Aa, Aa}}.
This results in the following state transition matrix.</p>

<p>
   $\begin{pmatrix}1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1/4 &amp; 1/2 &amp; 0 &amp; 1/4 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
1/16 &amp; 1/4 &amp; 1/8 &amp; 1/4 &amp; 1/4 &amp; 1/16\\
0 &amp; 0 &amp; 0 &amp; 1/4 &amp; 1/2 &amp; 1/4\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\end{pmatrix}$
</p>

<p>The rows mean from which state you start, the colums are the states you can get
to.</p>

<p>Now, how would you define this matrix with R?</p>
<div class="highlight">
   <pre><code class="language-r" data-lang="r">P <span class="o">=</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span><span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">16</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">8</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">16</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> byrow<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">6</span><span class="p">)</span>
</code></pre>
</div>
<p>And this is how you do it with Python: You first need to
<a href="http://docs.scipy.org/doc/numpy/user/install.html">install numpy</a>. This is
very easy with Linux (<code>sudo apt-get install python-numpy</code>), but I've heard
it is not that easy with Windows systems.</p>
<div class="highlight">
   <pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mi">16</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">16</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
</code></pre>
</div>
<p>A common matrix operation is taking the $n$-th power. This is how you do it
with R: First, install the library "expm" by executing <code>install.packages("expm")</code>.
Then</p>
<div class="highlight">
   <pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span><span class="s">"expm"</span><span class="p">)</span>
n <span class="o">=</span> <span class="m">5</span>
Pn <span class="o">=</span> P<span class="o">%^%</span>n
</code></pre>
</div>
<p>and this is the Python way:</p>
<div class="highlight">
   <pre><code class="language-python" data-lang="python"><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">Pn</span> <span class="o">=</span> <span class="n">P</span><span class="o">**</span><span class="n">n</span>
</code></pre>
</div>
<p>Visualizing data is a very important tool. For example, we want to know the
probabilities for the current state for the next 20 steps when you started in
$S_3$.</p>
<div class="highlight">
   <pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span><span class="s">"expm"</span><span class="p">)</span>
P <span class="o">=</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span>
             <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span><span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span>
             <span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span>
             <span class="m">1</span><span class="o">/</span><span class="m">16</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">8</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">16</span><span class="p">,</span>
             <span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="o">/</span><span class="m">4</span><span class="p">,</span>
             <span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> byrow<span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> nrow<span class="o">=</span><span class="m">6</span><span class="p">)</span>
v <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
<span class="kr">for</span> <span class="p">(</span>step <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">)</span> <span class="p">{</span>
    matplot<span class="p">(</span><span class="kp">t</span><span class="p">(</span><span class="kp">sapply</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span>
                     <span class="kr">function</span> <span class="p">(</span>step<span class="p">)</span> <span class="p">{</span>v <span class="o">%*%</span> <span class="p">(</span>P <span class="o">%^%</span> step<span class="p">)})),</span>
                     cex<span class="o">=</span><span class="m">0.7</span><span class="p">,</span>
                     ylab<span class="o">=</span><span class="s">""</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>
<p>This gives the following plot:</p>

<div style="width: 510px" class="wp-caption aligncenter">
   <a href="../images/2015/05/reproductin-rplot.png">
      <img src="http://martin-thoma.com/captions/reproductin-rplot.png" alt="State probabilities starting in S3 after 1..20 steps (plotted with R)" width="500" height="384" class="" />
   </a>
   <p class="wp-caption-text">State probabilities starting in S3 after 1..20 steps (plotted with R)</p>
</div>

<p>The Python equivalent is</p>
<div class="highlight">
   <pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mi">16</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">16</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span>
               <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>

<span class="c"># Get the data</span>
<span class="n">plot_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="n">P</span><span class="o">**</span><span class="n">step</span>
    <span class="n">plot_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>

<span class="c"># Convert the data format</span>
<span class="n">plot_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span>

<span class="c"># Create the plot</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Steps'</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Probability'</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">shape</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="p">[</span><span class="s">'x'</span><span class="p">,</span> <span class="s">'h'</span><span class="p">,</span> <span class="s">'H'</span><span class="p">,</span> <span class="s">'s'</span><span class="p">,</span> <span class="s">'8'</span><span class="p">,</span> <span class="s">'r+'</span><span class="p">]):</span>
    <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">shape</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"S</span><span class="si">%i</span><span class="s">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">lines</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>
<p>The result looks like this</p>

<div style="width: 510px" class="wp-caption aligncenter">
   <a href="../images/2015/01/image.png">
      <img src="" alt="State probabilities starting in S3 after 1..20 steps (plotted with Python)" width="" height="" class="" />
   </a>
   <p class="wp-caption-text">State probabilities starting in S3 after 1..20 steps (plotted with Python)</p>
</div>

<p>I've played around with the <a href="http://matplotlib.org/api/markers_api.html">matplotlib markers</a>
to make sure all points are visible.</p>

<h2 id="tocAnchor-1-2">Python Markov Packages</h2>

<p>There seem to be quite a few Python Markov chain packages:</p>
<div class="highlight">
   <pre><code class="language-text" data-lang="text">$ pip search markov
PyMarkovChain             - Simple markov chain implementation
autocomplete              - tiny 'autocomplete' tool using a "hidden markov model"
cobe                      - Markov chain based text generator library and chatbot
twitter_markov            - Create markov chain ("_ebooks") accounts on Twitter
markovgen                 - Another text generator based on Markov chains.
pyEMMA                    - EMMA: Emma's Markov Model Algorithms
pymc                      - Markov Chain Monte Carlo sampling toolkit.
hmmus                     - Posterior decoding with a hidden Markov model
marbl-python              - A Python implementation of the Marbl specification for normalized representations of Markov blankets in Bayesian networks.
pymdptoolbox              - Markov Decision Process (MDP) Toolbox
gibi                      - Generate random words based on Markov chains
markovgenerator           - Markov text generator
pythonic-porin            - Nanopore Data Analysis package. Provides tools for reading data,        performing event detection, segmentation, visualization, and
                            analysis using        hidden Markov models, and other tools. Designed for the UCSC Nanopore Group.
PyMarkovTextGenerator     - Random text generator base on Markov chains.
MCREPOGEN                 - Markov Chain Repository Generator
vokram                    - A toy Markov chain implementation.
MarkovEquClasses          - Algorithms for exploring Markov equivalence classes: MCMC, size counting
hmmlearn                  - Hidden Markov Models in Python with scikit-learn like API
twarkov                   - Markov generator built for generating Tweets from timelines
MCL_Markov_Cluster        - Markov Cluster algorithm implementation
pyborg                    - Markov chain bot for irc which generates replies to messages
pydodo                    - Markov chain generator
mwordgen                  - MWordGen is a Markov statistics based word generator.
Markov                    - Python library for Hidden Markov Models
markovify                 - Use Markov chains to generate random semi-plausible sentences based on an existing text.
treehmm                   - Variational Inference for tree-structured Hidden-Markov Models
PyMarkov                  - Markov Chains made easy
</code></pre>
</div>
<p>However, most of them are for hidden markov model training / evaluation.
There seems to be no package which can visualize markov chains just by taking
the state transition matrix.</p>

<p>There seems also not to be any package which makes it easy to classify states
as transient / recurrent, get the absorption time, ...</p>

<p>If somebody is interested in that, we could make a little project for it :-)</p>

<h3 id="tocAnchor-1-2-1">PyMarkovChain</h3>

<p>Source is on <a href="https://github.com/TehMillhouse/PyMarkovChain">github.com/TehMillhouse/PyMarkovChain</a>.
It is less than 150 lines of code and probably no functionality.</p>

<p>I asked the author to remove the package from PyPI (see <a href="https://github.com/TehMillhouse/PyMarkovChain/issues/13">issue #13</a>).</p>

<h3 id="tocAnchor-1-2-2">pyEMMA</h3>

<p>I've found the <a href="http://www.pythonhosted.org/pyEMMA/">documentation</a> and the
<a href="https://pypi.python.org/pypi/pyEMMA">project on PyPI</a>. The source is
on <a href="https://github.com/markovmodel/PyEMMA">github.com/markovmodel/PyEMMA</a>.</p>

<h3 id="tocAnchor-1-2-3">MarkovEquClasses</h3>

<p>
   <a href="https://pypi.python.org/pypi/MarkovEquClasses/1.0">PyPI</a>
</p>

<h3 id="tocAnchor-1-2-4">PyMarkov</h3>

<p>It is only about 100 lines of very simple code. It seems to be another
random sentence generator.
See <a href="https://pypi.python.org/pypi/PyMarkov">PyPI</a>.</p>

<h3 id="tocAnchor-1-2-5">Hidden Markov Models</h3>

<p>The following might be interesting, but I didn't take a close look at them
because I was looking for "normal" markov models:</p>

<ul>
<li>hmmus</li>
<li>hmmlearn</li>
<li>Markov</li>
<li>treehmm</li>
</ul>

<p>There are also quite a few other modules which seem to generate data with
markov chains.</p>

<h2 id="tocAnchor-1-8">TODO</h2>

<ul>
<li>http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3097064/</li>
<li>https://pymc-devs.github.io/pymc/README.html</li>
<li>https://github.com/riccardoscalco/Pykov</li>
</ul>

						</div>
						<div class="postmeta">Posted in 
                            
                                <a href="http://martin-thoma.com/category/code/">code</a><!--TODO: Displayed category name should be upper case! -->
                             | Tags: 
                            
                                
                                    <a href="http://martin-thoma.com/tag/python/">Python</a>
                                
                            
                                , <a href="http://martin-thoma.com/tag/markov-chain/">Markov Chain</a>
                                
                             by <a rel="author" class="vcard author" href="http://martin-thoma.com/author/martin-thoma/"><span class="fn">Martin Thoma</span></a> on <span class="updated"><span class="value-title" title="2015-05-12 20:45:00 +0200">
                                May 
                                12th
                                  , 
                                2015</span></span></div>

							<div class="navigation clearfix">
                                <div class="alignleft">
                                
                                    &laquo; <a href="http://martin-thoma.com/machine-learning-2-vorlesung/" rel="prev">Machine Learning 2 - Vorlesung</a>
                                 
                                </div>
								<div class="alignright">
                                
                                    <a href="http://martin-thoma.com/get-a-feeling-for-energy/" rel="next">Getting a Feeling for Energy</a> &raquo;
                                 
                                </div>
							</div>
	
						</article>
                        <div id="respond">
                            <h3>Leave a Reply</h3>
                                <!-- comment discuss code -->
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'martinthoma'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    <!-- comment discuss code -->

                        </div>
                    </div>
			    </div>
            <div class="span-8 last">
                <div id="subscriptions">
<a href="http://martin-thoma.com/feed/"><img src="http://martin-thoma.com/css/images/rss.png" alt="Subscribe to RSS Feed" title="Subscribe to RSS Feed" width="72" height="47" /></a>		
<a href="https://twitter.com/#!/themoosemind" title="Follow me on Twitter!"><img src="http://martin-thoma.com/css/images/twitter.png" title="Follow me on Twitter!" alt="Follow me on Twitter!"  width="76" height="47" /></a>
</div>

	            <div id="sidebar">
                <!-- type: searchbox.html - TODO-->
<ul>
    <li id="search">
        <div class="searchlayout">
            <form method="get" id="searchform" action="http://google.com/cse" role="search">
                <input type="hidden" name="cx" value="017345337424948206369:qrnnnentkkk" />
                <input type="search" value="" name="q" id="s" placeholder="Search with Google"/>
                <input type="image" src="http://martin-thoma.com/css/images/search.gif" style="border:0; vertical-align: top;" alt="search"/> 
            </form>
        </div>
    </li>
</ul>

                <div class="addthis_toolbox">   
    <div class="custom_images">
            <a href="http://twitter.com/share?url=http://martin-thoma.com/python-markov-chain-packages&amp;hashtags=python,markov-chain,&amp;via=themoosemind" target="_blank"><img src="http://martin-thoma.com/css/images/socialicons/twitter.png" width="32" height="32" alt="Twitter" /></a>
            <a href="http://del.icio.us/post?url=http://martin-thoma.com/python-markov-chain-packages&amp;title=Python%20Markov%20Chain%20Packages" target="_blank"><img src="http://martin-thoma.com/css/images/socialicons/delicious.png" width="32" height="32" alt="Delicious" /></a>
            <a href="http://www.facebook.com/sharer.php?u=http://martin-thoma.com/python-markov-chain-packages" target="_blank"><img src="http://martin-thoma.com/css/images/socialicons/facebook.png" width="32" height="32" alt="Facebook" /></a>
            <a href="http://digg.com/submit?phase=2&amp;url=http://martin-thoma.com/python-markov-chain-packages&amp;title=Python%20Markov%20Chain%20Packages" target="_blank"><img src="http://martin-thoma.com/css/images/socialicons/digg.png" width="32" height="32" alt="Digg" /></a>
            <a href="http://www.stumbleupon.com/submit?url=http://martin-thoma.com/python-markov-chain-packages&amp;title=Python%20Markov%20Chain%20Packages" target="_blank"><img src="http://martin-thoma.com/css/images/socialicons/stumbleupon.png" width="32" height="32" alt="Stumbleupon" /></a>
            <a href="https://plusone.google.com/_/+1/confirm?hl=en&amp;url=http://martin-thoma.com/python-markov-chain-packages" target="_blank"><img src="http://martin-thoma.com/css/images/socialicons/gplus.png" width="32" height="32" alt="Google Plus" /></a>
            <a href="http://reddit.com/submit?url=http://martin-thoma.com/python-markov-chain-packages&amp;title=Python%20Markov%20Chain%20Packages" target="_blank"><img src="http://martin-thoma.com/css/images/socialicons/reddit.png" width="32" height="32" alt="Reddit" /></a>
    </div>
</div>
			        
		        <ul>
                    <li id="categories-3" class="widget widget_categories">
                        <!-- type: categories -->
<h2 class="widgettitle">Categories</h2>
    <ul>
        <li class="cat-item cat-item-11"><a href="http://martin-thoma.com/category/code/" title="Tipps for coding in different languages like Python oder C++.">Code</a></li>
        <li class="cat-item cat-item-21"><a href="http://martin-thoma.com/category/web/" title="New emerging websites and technologies.">The Web</a></li>
        <li class="cat-item cat-item-31"><a href="http://martin-thoma.com/category/cyberculture/" title="Lolcats, planking, Trollfaces, ...">Cyberculture</a></li>
        <li class="cat-item cat-item-3404"><a href="http://martin-thoma.com/category/maths/" title="View all posts filed under Mathematics">Mathematics</a></li>
        <li class="cat-item cat-item-881"><a href="http://martin-thoma.com/category/bits-and-bytes/" title="Sometimes posts don&#039;t fit in any category.">My bits and bytes</a></li>
        <li class="cat-item cat-item-41"><a href="http://martin-thoma.com/category/deutschland/" title="[All Posts here are written in German about German topics] - Die Bahn, unsere Politik und Europa.">German posts</a></li>
	</ul>

                    </li>
                    <li id="tag_cloud-3" class="widget widget_tag_cloud">
                        <h2 class="widgettitle">Tags</h2>
                        <div class="tagcloud"><a style='font-size: 131.76%' href='http://martin-thoma.com/tag/ai/' title='9 topics'>AI</a>
<a style='font-size: 102.95%' href='http://martin-thoma.com/tag/algebra/' title='6 topics'>Algebra</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/assembly-language/' title='5 topics'>Assembly language</a>
<a style='font-size: 102.95%' href='http://martin-thoma.com/tag/bash/' title='6 topics'>Bash</a>
<a style='font-size: 195.26%' href='http://martin-thoma.com/tag/c/' title='22 topics'>C</a>
<a style='font-size: 139.24%' href='http://martin-thoma.com/tag/cpp/' title='10 topics'>CPP</a>
<a style='font-size: 113.90%' href='http://martin-thoma.com/tag/challenge/' title='7 topics'>Challenge</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/chrome/' title='5 topics'>Chrome</a>
<a style='font-size: 139.24%' href='http://martin-thoma.com/tag/clip/' title='10 topics'>Clip</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/command-line/' title='5 topics'>Command Line</a>
<a style='font-size: 102.95%' href='http://martin-thoma.com/tag/computer-science/' title='6 topics'>Computer science</a>
<a style='font-size: 123.39%' href='http://martin-thoma.com/tag/digitaltechnik/' title='8 topics'>Digitaltechnik</a>
<a style='font-size: 102.95%' href='http://martin-thoma.com/tag/flashgames/' title='6 topics'>Flashgames</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/geometry/' title='5 topics'>Geometry</a>
<a style='font-size: 131.76%' href='http://martin-thoma.com/tag/google/' title='9 topics'>Google</a>
<a style='font-size: 123.39%' href='http://martin-thoma.com/tag/google-code-jam/' title='8 topics'>Google Code Jam</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/html5/' title='5 topics'>HTML5</a>
<a style='font-size: 131.76%' href='http://martin-thoma.com/tag/it-security/' title='9 topics'>IT-Security</a>
<a style='font-size: 228.24%' href='http://martin-thoma.com/tag/java/' title='35 topics'>Java</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/javascript/' title='5 topics'>JavaScript</a>
<a style='font-size: 176.94%' href='http://martin-thoma.com/tag/kit/' title='17 topics'>KIT</a>
<a style='font-size: 209.81%' href='http://martin-thoma.com/tag/klausur/' title='27 topics'>Klausur</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/kogsys/' title='5 topics'>KogSys</a>
<a style='font-size: 204.34%' href='http://martin-thoma.com/tag/latex/' title='25 topics'>LaTeX</a>
<a style='font-size: 181.00%' href='http://martin-thoma.com/tag/linear-algebra/' title='18 topics'>Linear algebra</a>
<a style='font-size: 172.63%' href='http://martin-thoma.com/tag/linux/' title='16 topics'>Linux</a>
<a style='font-size: 102.95%' href='http://martin-thoma.com/tag/machine-learning/' title='6 topics'>Machine Learning</a>
<a style='font-size: 123.39%' href='http://martin-thoma.com/tag/matrix/' title='8 topics'>Matrix</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/os/' title='5 topics'>OS</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/operating-systems/' title='5 topics'>Operating Systems</a>
<a style='font-size: 113.90%' href='http://martin-thoma.com/tag/php/' title='7 topics'>PHP</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/physics/' title='5 topics'>Physics</a>
<a style='font-size: 241.19%' href='http://martin-thoma.com/tag/programming/' title='42 topics'>Programming</a>
<a style='font-size: 131.76%' href='http://martin-thoma.com/tag/project-euler/' title='9 topics'>Project Euler</a>
<a style='font-size: 270.00%' href='http://martin-thoma.com/tag/python/' title='63 topics'>Python</a>
<a style='font-size: 102.95%' href='http://martin-thoma.com/tag/review/' title='6 topics'>Review</a>
<a style='font-size: 131.76%' href='http://martin-thoma.com/tag/swt-i/' title='9 topics'>SWT I</a>
<a style='font-size: 131.76%' href='http://martin-thoma.com/tag/theoretical-computer-science/' title='9 topics'>Theoretical computer science</a>
<a style='font-size: 102.95%' href='http://martin-thoma.com/tag/tikz/' title='6 topics'>Tikz</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/ubuntu/' title='5 topics'>Ubuntu</a>
<a style='font-size: 157.88%' href='http://martin-thoma.com/tag/video/' title='13 topics'>Video</a>
<a style='font-size: 131.76%' href='http://martin-thoma.com/tag/vimeo/' title='9 topics'>Vimeo</a>
<a style='font-size: 139.24%' href='http://martin-thoma.com/tag/web-development/' title='10 topics'>Web Development</a>
<a style='font-size: 102.95%' href='http://martin-thoma.com/tag/wikipedia/' title='6 topics'>Wikipedia</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/windows-7/' title='5 topics'>Windows 7</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/wolfram-alpha/' title='5 topics'>Wolfram|Alpha</a>
<a style='font-size: 146.01%' href='http://martin-thoma.com/tag/youtube/' title='11 topics'>YouTube</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/advertising/' title='5 topics'>advertising</a>
<a style='font-size: 123.39%' href='http://martin-thoma.com/tag/algorithms/' title='8 topics'>algorithms</a>
<a style='font-size: 113.90%' href='http://martin-thoma.com/tag/analysis/' title='7 topics'>analysis</a>
<a style='font-size: 90.00%' href='http://martin-thoma.com/tag/cheat-sheet/' title='5 topics'>cheat sheet</a>
<a style='font-size: 168.05%' href='http://martin-thoma.com/tag/funny/' title='15 topics'>funny</a>
<a style='font-size: 168.05%' href='http://martin-thoma.com/tag/learning/' title='15 topics'>learning</a>
<a style='font-size: 139.24%' href='http://martin-thoma.com/tag/lecture-notes/' title='10 topics'>lecture-notes</a>
<a style='font-size: 257.72%' href='http://martin-thoma.com/tag/mathematics/' title='53 topics'>mathematics</a>
<a style='font-size: 191.95%' href='http://martin-thoma.com/tag/puzzle/' title='21 topics'>puzzle</a>
</div>
                    </li>
                </ul>
	            </div>
            </div>
		</div><!--/container-->
			<footer id="footer">
				<a href="http://martin-thoma.com"><strong>Martin Thoma</strong></a> -  A blog about Code, the Web and Cyberculture. <br />
                <div class="footer-credits">
                    <a href="http://flexithemes.com/themes/modern-style/">Modern Style</a> theme by <a href="http://flexithemes.com/">FlexiThemes</a>
                </div>
			</footer><!--/footer-->
            
	</div><!--/wrapper-->
<!-- type: footer -->
<!-- MathJax -->
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript">
<!--
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [ ['$$', '$$']],
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    processEscapes: true
  }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
// -->
</script>
<!-- TOC Plus -->
<script type='text/javascript'>
/* <![CDATA[ */
var tocplus = {"visibility_show":"show","visibility_hide":"hide","width":"275px"};
/* ]]> */
</script>
<script type='text/javascript' src="http://martin-thoma.com/js/tocplus-front.js"></script>

</body>
</html>

